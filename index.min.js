/*! (c) Andrea Giammarchi - ISC */
const e=new WeakMap;const t=new class{constructor(){e.set(this,{v:new Map,f:new Map})}all(t,n){const{v:r,f:s}=e.get(this);s.has(t)||s.set(t,new Set),s.get(t).add(n),r.has(t)&&Promise.resolve(r.get(t)).then(n)}drop(t){const{v:n,f:r}=e.get(this);1<arguments.length?r.has(t)&&r.get(t).delete(arguments[1]):(n.delete(t),r.delete(t))}that(t){if(!(1<arguments.length))return e=>this.that(t,e);{const n=arguments[1],{v:r,f:s}=e.get(this);if(r.set(t,n),s.has(t))for(const e of s.get(t))e(n)}}when(t){const{v:n}=e.get(this);return n.has(t)?Promise.resolve(n.get(t)):new Promise((e=>{const n=r=>{this.drop(t,n),e(r)};this.all(t,n)}))}};function n(e){const t="string"==typeof e?[e]:[e[0]];for(let n=1,{length:r}=arguments;n<r;n++)t.push(arguments[n],e[n]);const n=document.createElement("style");return n.type="text/css",n.appendChild(document.createTextNode(t.join(""))),document.head.appendChild(n)}let r="sticky_"+(""+Math.random()).replace(".",""),s=1;var o=()=>r+""+ ++s;function l(e,t){e&&(e.value=t,((e,t)=>{document.documentElement.style.setProperty("--"+e,t)})(e.uid,e.value))}const a=/--([a-z]+[a-z0-9-]*)\s*(,\s*.+)*\)/gi;const c=o();function i(e){!function({view:e,model:r={},handleEvent:s=u,style:d,children:f={},init:p}){if(!e||"function"!=typeof e)throw console.error("inputs leading to error:",{view:e,model:r,handleEvent:s,style:d,children:f}),"view property is missing!";o(),r.broadcast=function(e){for(const n of m)n(e)&&t.that(c,"binding")},r.handleEvent=s;let h=function(e){let t={},r={};if(e)for(const[s,c]of Object.entries(e)){t[s]=o();let e=[...c.matchAll(a)].map((e=>{return{name:e[1],value:(t=e[2],t?.replace(/\s|,/g,"")||""),uid:o()};var t})),i=c;for(const{name:t,value:n,uid:o}of e){r[t]={value:n,uid:o};const e=new RegExp("--"+s);i=i.replace(e,"--"+o),l(r[t],n)}n`
                .${t[s]} {
                    ${i}
                }
            `}return{classNameToUid:t,setCssVariable:(e,t)=>l(r[e],t)}}(d);r.style=d?h.classNameToUid:{};let m=[];for(const e of Object.keys(f))r[e]=i(f[e])}("function"==typeof e?e():e)}function u(){}class d extends Map{set(e,t){return super.set(e,t),t}}class f extends WeakMap{set(e,t){return super.set(e,t),t}}
/*! (c) Andrea Giammarchi - ISC */const p=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,h=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/?)>/g,m=/([^\s\\>"'=]+)\s*=\s*(['"]?)\x01/g,g=/[\x01\x02]/g;const y=(e,t)=>111===e.nodeType?1/t<0?t?(({firstChild:e,lastChild:t})=>{const n=document.createRange();return n.setStartAfter(e),n.setEndAfter(t),n.deleteContents(),e})(e):e.lastChild:t?e.valueOf():e.firstChild:e,{isArray:v}=Array,w=e=>null==e?e:e.valueOf(),b=(e,t)=>{let n,r,s=t.slice(2);return!(t in e)&&(r=t.toLowerCase())in e&&(s=r.slice(2)),t=>{const r=v(t)?t:[t,!1];n!==r[0]&&(n&&e.removeEventListener(s,n,r[1]),(n=r[0])&&e.addEventListener(s,n,r[1]))}};const{isArray:x,prototype:N}=Array,{indexOf:C}=N,{createDocumentFragment:E,createElement:A,createElementNS:k,createTextNode:T,createTreeWalker:M,importNode:O}=new Proxy(document,{get:(e,t)=>e[t].bind(e)});let $;const S=(e,t)=>t?(e=>{$||($=k("http://www.w3.org/2000/svg","svg")),$.innerHTML=e;const t=E();return t.append(...$.childNodes),t})(e):(e=>{const t=A("template");return t.innerHTML=e,t.content})(e),L=({childNodes:e},t)=>e[t],j=(e,t,n)=>((e,t,n,r,s)=>{const o=n.length;let l=t.length,a=o,c=0,i=0,u=null;for(;c<l||i<a;)if(l===c){const t=a<o?i?r(n[i-1],-0).nextSibling:r(n[a-i],0):s;for(;i<a;)e.insertBefore(r(n[i++],1),t)}else if(a===i)for(;c<l;)u&&u.has(t[c])||e.removeChild(r(t[c],-1)),c++;else if(t[c]===n[i])c++,i++;else if(t[l-1]===n[a-1])l--,a--;else if(t[c]===n[a-1]&&n[i]===t[l-1]){const s=r(t[--l],-1).nextSibling;e.insertBefore(r(n[i++],1),r(t[c++],-1).nextSibling),e.insertBefore(r(n[--a],1),s),t[l]=n[a]}else{if(!u){u=new Map;let e=i;for(;e<a;)u.set(n[e],e++)}if(u.has(t[c])){const s=u.get(t[c]);if(i<s&&s<a){let o=c,d=1;for(;++o<l&&o<a&&u.get(t[o])===s+d;)d++;if(d>s-i){const o=r(t[c],0);for(;i<s;)e.insertBefore(r(n[i++],1),o)}else e.replaceChild(r(n[i++],1),r(t[c++],-1))}else c++}else e.removeChild(r(t[c++],-1))}return n})(e.parentNode,t,n,y,e),P=(e,t)=>{switch(t[0]){case"?":return((e,t,n)=>r=>{const s=!!w(r);n!==s&&((n=s)?e.setAttribute(t,""):e.removeAttribute(t))})(e,t.slice(1),!1);case".":return((e,t)=>"dataset"===t?(({dataset:e})=>t=>{for(const n in t){const r=t[n];null==r?delete e[n]:e[n]=r}})(e):n=>{e[t]=n})(e,t.slice(1));case"@":return b(e,"on"+t.slice(1));case"o":if("n"===t[1])return b(e,t)}switch(t){case"ref":return(e=>{let t;return n=>{t!==n&&(t=n,"function"==typeof n?n(e):n.current=e)}})(e);case"aria":return(e=>t=>{for(const n in t){const r="role"===n?n:`aria-${n}`,s=t[n];null==s?e.removeAttribute(r):e.setAttribute(r,s)}})(e)}return((e,t)=>{let n,r=!0;const s=document.createAttributeNS(null,t);return t=>{const o=w(t);n!==o&&(null==(n=o)?r||(e.removeAttributeNode(s),r=!0):(s.value=o,r&&(e.setAttributeNodeNS(s),r=!1)))}})(e,t)};function _(e){const{type:t,path:n}=e,r=n.reduceRight(L,this);return"node"===t?(e=>{let t,n,r=[];const s=o=>{switch(typeof o){case"string":case"number":case"boolean":t!==o&&(t=o,n||(n=T("")),n.data=o,r=j(e,r,[n]));break;case"object":case"undefined":if(null==o){t!=o&&(t=o,r=j(e,r,[]));break}if(x(o)){t=o,0===o.length?r=j(e,r,[]):"object"==typeof o[0]?r=j(e,r,o):s(String(o));break}if(t!==o)if("ELEMENT_NODE"in o)t=o,r=j(e,r,11===o.nodeType?[...o.childNodes]:[o]);else{const e=o.valueOf();e!==o&&s(e)}break;case"function":s(o(e))}};return s})(r):"attr"===t?P(r,e.name):(e=>{let t;return n=>{const r=w(n);t!=r&&(t=r,e.textContent=null==r?"":r)}})(r)}const z=e=>{const t=[];let{parentNode:n}=e;for(;n;)t.push(C.call(n.childNodes,e)),e=n,({parentNode:n}=e);return t},B=new f,D=/^(?:textarea|script|style|title|plaintext|xmp)$/,H=(e,t)=>{const n="svg"===e,r=((e,t,n)=>{let r=0;return e.join("").trim().replace(h,((e,t,r,s)=>{let o=t+r.replace(m,"=$2$1").trimEnd();return s.length&&(o+=n||p.test(t)?" /":"></"+t),"<"+o+">"})).replace(g,(e=>""===e?"\x3c!--"+t+r+++"--\x3e":t+r++))})(t,"isµ",n),s=S(r,n),o=M(s,129),l=[],a=t.length-1;let c=0,i=`isµ${c}`;for(;c<a;){const e=o.nextNode();if(!e)throw`bad template: ${r}`;if(8===e.nodeType)e.data===i&&(l.push({type:"node",path:z(e)}),i="isµ"+ ++c);else{for(;e.hasAttribute(i);)l.push({type:"attr",path:z(e),name:e.getAttribute(i)}),e.removeAttribute(i),i="isµ"+ ++c;D.test(e.localName)&&e.textContent.trim()===`\x3c!--${i}--\x3e`&&(e.textContent="",l.push({type:"text",path:z(e)}),i="isµ"+ ++c)}}return{content:s,nodes:l}},R=(e,t)=>{const{content:n,nodes:r}=B.get(t)||B.set(t,H(e,t)),s=O(n,!0);return{content:s,updates:r.map(_,s)}},W=(e,{type:t,template:n,values:r})=>{const s=I(e,r);let{entry:o}=e;o&&o.template===n&&o.type===t||(e.entry=o=((e,t)=>{const{content:n,updates:r}=R(e,t);return{type:e,template:t,content:n,updates:r,wire:null}})(t,n));const{content:l,updates:a,wire:c}=o;for(let e=0;e<s;e++)a[e](r[e]);return c||(o.wire=(e=>{const{firstChild:t,lastChild:n}=e;if(t===n)return n||e;const{childNodes:r}=e,s=[...r];return{ELEMENT_NODE:1,nodeType:111,firstChild:t,lastChild:n,valueOf:()=>(r.length!==s.length&&e.append(...s),e)}})(l))},I=({stack:e},t)=>{const{length:n}=t;for(let r=0;r<n;r++){const n=t[r];n instanceof U?t[r]=W(e[r]||(e[r]={stack:[],entry:null,wire:null}),n):x(n)?I(e[r]||(e[r]={stack:[],entry:null,wire:null}),n):e[r]=null}return n<e.length&&e.splice(n),n};class U{constructor(e,t,n){this.type=e,this.template=t,this.values=n}}const F=e=>{const t=new f;return Object.assign(((t,...n)=>new U(e,t,n)),{for(n,r){const s=t.get(n)||t.set(n,new d);return s.get(r)||s.set(r,(t=>(n,...r)=>W(t,{type:e,template:n,values:r}))({stack:[],entry:null,wire:null}))},node:(t,...n)=>W({stack:[],entry:null,wire:null},new U(e,t,n)).valueOf()})},K=F("html");F("svg");const V=function(e,n,r=document.body){const s=i(e);console.log("comp",s);const o=()=>n(r,K`${s.render()}`);return t.all(c,(()=>{console.log("STICKY_CHANNEL"),o()})),setInterval(o,500),{component:s,render:o}},Y=i;export{V as controller,Y as sticky};
